(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50111,       1291]
NotebookOptionsPosition[     49689,       1272]
NotebookOutlinePosition[     50047,       1288]
CellTagsIndexPosition[     50004,       1285]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"GeneralLinearAnizatropy", "[", 
   RowBox[{
   "\[Alpha]0_", ",", "U0_", ",", "\[Chi]0_", ",", "\[Theta]0_", ",", 
    "\[Beta]0_", ",", "P0_"}], "]"}], ":=", " ", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "=", "\[Alpha]0"}], ",", 
      RowBox[{"U", "=", "U0"}], ",", 
      RowBox[{"\[Chi]", "=", "\[Chi]0"}], ",", 
      RowBox[{"\[Theta]", "=", "\[Theta]0"}], ",", 
      RowBox[{"\[Beta]", "=", "\[Beta]0"}], ",", 
      RowBox[{"P", "=", "P0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"\[Alpha]", " ", "-", " ", "dissipation"}], ",", " ", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"\[Nu]", "/", "\[Omega]"}]}], ",", " ", 
      RowBox[{"\[Omega]", "\[Rule]", 
       RowBox[{"\[Omega]", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[ImaginaryI]\[Alpha]"}], ")"}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"U", " ", "-", " ", 
        RowBox[{"anizatropy", ":", " ", 
         RowBox[{"p", "^", "2"}]}]}], "=", 
       RowBox[{"4", 
        RowBox[{"\[Pi]e", "^", "2"}], "*", 
        RowBox[{"n", "/", "m"}]}]}], ",", " ", 
      RowBox[{"b", "=", 
       RowBox[{"eB", "/", 
        RowBox[{"(", "mc", ")"}]}]}], ",", " ", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"p", "^", "2"}], "/", 
        RowBox[{"\[Omega]", "^", "2"}]}]}], ",", " ", 
      RowBox[{"u", "=", 
       RowBox[{
        RowBox[{"b", "^", "2"}], "/", 
        RowBox[{"\[Omega]", "^", "2"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"and", " ", "with", " ", 
        RowBox[{"dissipation", ":", " ", "v"}]}], "\[Rule]", 
       RowBox[{"v", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[ImaginaryI]\[Alpha]"}], ")"}]}]}], ",", " ", 
      RowBox[{"u", "\[Rule]", 
       RowBox[{"U", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[ImaginaryI]\[Alpha]"}], ")"}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Chi]", " ", "-", " ", 
        RowBox[{
        "dimensionless", " ", "wave", " ", "vector", " ", "magnitude"}]}], 
       ";", " ", 
       RowBox[{"\[Chi]", "=", 
        RowBox[{
         SubscriptBox["k", "0"], "L"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"and", " ", "L"}], "=", "1"}]}], "*)"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"\[Theta]", " ", "-", " ", 
      RowBox[{
      "ngel", " ", "between", " ", "wave", " ", "vector", " ", "and", " ", 
       "XOZ"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"\[Beta]", " ", "-", " ", 
      RowBox[{
      "angle", " ", "between", " ", "wave", " ", "vector", " ", "and", " ", 
       "magnetic", " ", "field", " ", "direction"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"P", " ", "-", " ", 
       RowBox[{"wave", " ", "polarisation"}]}], ";", " ", 
      RowBox[{
       RowBox[{"2", "d"}], "-", "vector"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
       "===", "===", "===", "===", "===", "==="}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Plasma", " ", "configuration"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"X", "=", "3"}], ";", 
     RowBox[{"(*", 
      RowBox[{"plasma", " ", "boundary"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]", "=", "0.05"}], ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"smoothing", " ", "width"}], ",", " ", 
       RowBox[{
       "in", " ", "parts", " ", "of", " ", "plasma", " ", "whight"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"1", "/", "\[CapitalDelta]"}]}], ";", " ", 
     RowBox[{"smoothingFunc", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["x", "X"], ")"}], 
            RowBox[{"2", "n"}]]}], ")"}], 
         RowBox[{"-", "1"}]]}], "]"}]}], ";", " ", 
     RowBox[{"v", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["X", "2"], "-", 
            SuperscriptBox["x", "2"]}], 
           RowBox[{
            SuperscriptBox["X", "2"], "-", "1"}]], ")"}], "*", 
         RowBox[{"smoothingFunc", "[", "x", "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"\[ImaginaryI]", "*", "\[Alpha]"}]}], ")"}]}]}], "]"}]}], 
     ";", " ", 
     RowBox[{"u", "=", 
      RowBox[{"U", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[ImaginaryI]", "*", "\[Alpha]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Eps", "=", 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"v", "[", "x", "]"}], 
            RowBox[{"1", "-", "u"}]]}], 
          RowBox[{"\[ImaginaryI]", 
           FractionBox[
            SqrtBox["u"], 
            RowBox[{"1", "-", "u"}]], 
           RowBox[{"v", "[", "x", "]"}]}], "0"},
         {
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], 
           FractionBox[
            SqrtBox["u"], 
            RowBox[{"1", "-", "u"}]], 
           RowBox[{"v", "[", "x", "]"}]}], 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"v", "[", "x", "]"}], 
            RowBox[{"1", "-", "u"}]]}], "0"},
         {"0", "0", 
          RowBox[{"1", "-", 
           RowBox[{"v", "[", "x", "]"}]}]}
        }], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"Eps", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"Im", "[", 
           RowBox[{"Eps", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "3"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "X"}], ",", 
          RowBox[{"2", "X"}]}], "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Wave", " ", "configuration"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"A", "=", "1"}], ";", 
     RowBox[{"(*", 
      RowBox[{"wave", " ", "magnitude"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"\[Chi]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], 
              RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
            {
             RowBox[{"Sin", "[", "\[Theta]", "]"}]},
            {
             RowBox[{
              RowBox[{"Cos", "[", "\[Theta]", "]"}], 
              RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}
           }], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"wave", " ", "vector"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[CapitalEpsilon]", "=", 
      RowBox[{
       FractionBox["A", 
        RowBox[{"Norm", "[", "P", "]"}]], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            RowBox[{"Cos", "[", "\[Beta]", "]"}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
             RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
           {"0", 
            RowBox[{"Cos", "[", "\[Theta]", "]"}]},
           {
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Beta]", "]"}]}], 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
             RowBox[{"Cos", "[", "\[Beta]", "]"}]}]}
          }], ")"}], ".", "P"}]}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Electric", " ", "field", " ", 
       RowBox[{"(", 
        RowBox[{"!!", 
         RowBox[{"!", 
          RowBox[{
           RowBox[{"ESCAPE_SEQUENCE", "!!"}], "!"}]}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalBeta]", "=", 
      FractionBox[
       RowBox[{"k", "\[Cross]", "\[CapitalEpsilon]"}], "\[Chi]"]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Magnetic", " ", "field", " ", 
       RowBox[{"(", 
        RowBox[{"!!", 
         RowBox[{"!", 
          RowBox[{
           RowBox[{"ESCAPE_SEQUENCE", "!!"}], "!"}]}]}], ")"}]}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Maxwell", " ", "equations"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"GeneralSystem", " ", "=", " ", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Ex", "[", "x", "]"}], "*", 
             RowBox[{
              RowBox[{"Eps", "[", "x", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"Ey", "[", "x", "]"}], "*", 
             RowBox[{
              RowBox[{"Eps", "[", "x", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], "\[Equal]", 
           RowBox[{
            RowBox[{"kz", "*", 
             RowBox[{"By", "[", "x", "]"}]}], "-", 
            RowBox[{"ky", "*", 
             RowBox[{"Bz", "[", "x", "]"}]}]}]}], ",", " ", 
          RowBox[{
           RowBox[{"Bx", "[", "x", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"ky", "*", 
             RowBox[{"Ez", "[", "x", "]"}]}], "-", 
            RowBox[{"kz", "*", 
             RowBox[{"Ey", "[", "x", "]"}]}]}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Ey", "'"}], "[", "x", "]"}], "==", 
          RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ky", "*", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kz", "*", 
                  RowBox[{"By", "[", "x", "]"}]}], "-", 
                 RowBox[{"ky", "*", 
                  RowBox[{"Bz", "[", "x", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Ey", "[", "x", "]"}], "*", 
                  RowBox[{"Eps", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
               RowBox[{"Eps", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], "+", 
             RowBox[{"Bz", "[", "x", "]"}]}], ")"}]}]}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Ey", "'"}], "[", "x", "]"}], "==", 
           RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ky", "*", 
               RowBox[{"Ex", "[", "x", "]"}]}], "+", 
              RowBox[{"Bz", "[", "x", "]"}]}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Ez", "'"}], "[", "x", "]"}], "==", 
          RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kz", "*", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kz", "*", 
                  RowBox[{"By", "[", "x", "]"}]}], "-", 
                 RowBox[{"ky", "*", 
                  RowBox[{"Bz", "[", "x", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Ey", "[", "x", "]"}], "*", 
                  RowBox[{"Eps", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
               RowBox[{"Eps", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], "-", 
             RowBox[{"By", "[", "x", "]"}]}], ")"}]}]}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"Ez", "'"}], "[", "x", "]"}], "==", 
           RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"kz", "*", 
               RowBox[{"Ex", "[", "x", "]"}]}], "-", 
              RowBox[{"By", "[", "x", "]"}]}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"By", "'"}], "[", "x", "]"}], "==", 
          RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ky", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ky", "*", 
                 RowBox[{"Ez", "[", "x", "]"}]}], "-", 
                RowBox[{"kz", "*", 
                 RowBox[{"Ey", "[", "x", "]"}]}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"Eps", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
              RowBox[{"Ez", "[", "x", "]"}]}]}], ")"}]}]}], ",", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"By", "'"}], "[", "x", "]"}], "==", 
           RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ky", "*", 
               RowBox[{"Bx", "[", "x", "]"}]}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"Eps", "[", "x", "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "3"}], "]"}], "]"}], "*", 
               RowBox[{"Ez", "[", "x", "]"}]}]}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Bz", "'"}], "[", "x", "]"}], "==", 
          RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kz", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ky", "*", 
                 RowBox[{"Ez", "[", "x", "]"}]}], "-", 
                RowBox[{"kz", "*", 
                 RowBox[{"Ey", "[", "x", "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"Eps", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
              FractionBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"kz", "*", 
                  RowBox[{"By", "[", "x", "]"}]}], "-", 
                 RowBox[{"ky", "*", 
                  RowBox[{"Bz", "[", "x", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Ey", "[", "x", "]"}], "*", 
                  RowBox[{"Eps", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
               RowBox[{"Eps", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]]}], "+", 
             RowBox[{
              RowBox[{"Eps", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"Ey", "[", "x", "]"}]}]}], ")"}]}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"Bz", "'"}], "[", "x", "]"}], "==", 
          RowBox[{"\[ImaginaryI]", "*", "\[Chi]", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"kz", "*", 
              RowBox[{"Bx", "[", "x", "]"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"Eps", "[", "x", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"Ex", "[", "x", "]"}]}], "+", 
             RowBox[{
              RowBox[{
               RowBox[{"Eps", "[", "x", "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}], "*", 
              RowBox[{"Ey", "[", "x", "]"}]}]}], ")"}]}]}], "*)"}], 
        "\[IndentingNewLine]", "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kx", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"ky", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"kz", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "\[Chi]"}]}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"GeneralInitials", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Ey", "[", 
          RowBox[{"2", "X"}], "]"}], "\[Equal]", 
         RowBox[{"\[CapitalEpsilon]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Ez", "[", 
          RowBox[{"2", "X"}], "]"}], "\[Equal]", 
         RowBox[{"\[CapitalEpsilon]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"By", "[", 
          RowBox[{"2", "X"}], "]"}], "\[Equal]", 
         RowBox[{"\[CapitalBeta]", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Bz", "[", 
          RowBox[{"2", "X"}], "]"}], "\[Equal]", 
         RowBox[{"\[CapitalBeta]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sol", "=", 
      RowBox[{"NDSolveValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"GeneralSystem", ",", "GeneralInitials"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Ey", ",", "Ez", ",", "By", ",", "Bz"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{
           RowBox[{"-", "2"}], "X"}], ",", 
          RowBox[{"2", "X"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Polarisation", " ", "rotations"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Transmitted", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"P", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]]}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             FractionBox[
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"Norm", "[", "P", "]"}]]},
            {
             FractionBox[
              RowBox[{"P", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"Norm", "[", "P", "]"}]]}
           }], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Transmitted", " ", "wave"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"IW", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Cos", "[", "\[Beta]", "]"}], "0", 
               RowBox[{"-", 
                RowBox[{"Sin", "[", "\[Beta]", "]"}]}]},
              {
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Sin", "[", "\[Beta]", "]"}]}], 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
               RowBox[{"Cos", "[", "\[Theta]", "]"}], 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", "\[Beta]", "]"}]}], 
                RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"kz", "*", 
                   RowBox[{"By", "[", "x", "]"}]}], "-", 
                  RowBox[{"ky", "*", 
                   RowBox[{"Bz", "[", "x", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Ey", "[", "x", "]"}], "*", 
                   RowBox[{"Eps", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
                RowBox[{"Eps", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]]},
              {
               RowBox[{"Ey", "[", "x", "]"}]},
              {
               RowBox[{"Ez", "[", "x", "]"}]}
             }], ")"}]}], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kx", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"ky", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"kz", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{
          RowBox[{"Ey", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Ez", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"By", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Bz", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", "x", "]"}]}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"IP", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            RowBox[{"a", "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "+", 
                    RowBox[{"b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"IW", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"IW", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]},
           {
            RowBox[{"a", "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "+", 
                    RowBox[{"b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"IW", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"IW", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}
          }], ")"}], "\[Transpose]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Initial", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IP", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"IP", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"IP", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"IP", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"IP", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]]}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             FractionBox[
              RowBox[{"IP", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"Norm", "[", "IP", "]"}]]},
            {
             FractionBox[
              RowBox[{"IP", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"Norm", "[", "IP", "]"}]]}
           }], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Initial", " ", "wave"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"RW", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", GridBox[{
              {
               RowBox[{"Cos", "[", 
                RowBox[{"\[Pi]", "-", "\[Beta]"}], "]"}], "0", 
               RowBox[{"-", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Pi]", "-", "\[Beta]"}], "]"}]}]},
              {
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Pi]", "-", "\[Beta]"}], "]"}]}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"-", "\[Theta]"}], "]"}]}], 
               RowBox[{"Cos", "[", 
                RowBox[{"-", "\[Theta]"}], "]"}], 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Pi]", "-", "\[Beta]"}], "]"}]}], 
                RowBox[{"Sin", "[", 
                 RowBox[{"-", "\[Theta]"}], "]"}]}]}
             }], ")"}], ".", 
           RowBox[{"(", GridBox[{
              {
               FractionBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"kz", "*", 
                   RowBox[{"By", "[", "x", "]"}]}], "-", 
                  RowBox[{"ky", "*", 
                   RowBox[{"Bz", "[", "x", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Ey", "[", "x", "]"}], "*", 
                   RowBox[{"Eps", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
                RowBox[{"Eps", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "1"}], "]"}], "]"}]]},
              {
               RowBox[{"Ey", "[", "x", "]"}]},
              {
               RowBox[{"Ez", "[", "x", "]"}]}
             }], ")"}]}], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"kx", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"ky", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{"kz", "\[Rule]", 
          RowBox[{
           RowBox[{"k", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "/", "\[Chi]"}]}], ",", 
         RowBox[{
          RowBox[{"Ey", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Ez", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"By", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "[", "x", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Bz", "[", "x", "]"}], "\[Rule]", 
          RowBox[{
           RowBox[{"Sol", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "[", "x", "]"}]}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"RP", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            RowBox[{"b", "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "+", 
                    RowBox[{"b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"RW", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"RW", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]},
           {
            RowBox[{"b", "/.", 
             RowBox[{
              RowBox[{"NSolve", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "+", 
                    RowBox[{"b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"RW", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "a", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}], "-", 
                    RowBox[{"\[ImaginaryI]", "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "b", "*", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], "*", 
                    RowBox[{"k", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}], "]"}]}]}], "\[Equal]", 
                    RowBox[{"D", "[", 
                    RowBox[{
                    RowBox[{"RW", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}]}], "/.", 
                   RowBox[{"x", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "X"}], ")"}]}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "b"}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}
          }], ")"}], "\[Transpose]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Reflected", "=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RP", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"RP", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"RP", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]], ",", 
         FractionBox[
          RowBox[{"Conjugate", "[", 
           RowBox[{"RP", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], 
          RowBox[{"Abs", "[", 
           RowBox[{"RP", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]]}], "]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             FractionBox[
              RowBox[{"RP", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"Norm", "[", "RP", "]"}]]},
            {
             FractionBox[
              RowBox[{"RP", "[", 
               RowBox[{"[", "2", "]"}], "]"}], 
              RowBox[{"Norm", "[", "RP", "]"}]]}
           }], ")"}], "\[Transpose]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"Reflected", " ", "wave"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", "Dissipation", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Dissipation", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"Norm", "[", "RP", "]"}], 
        RowBox[{"Norm", "[", "IP", "]"}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", 
       "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
        "===", "===", "===", "===", "===", "===", "==="}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Eps", ",", "k", ",", "Sol", ",", "Initial", ",", "Reflected", ",", 
       "Transmitted", ",", "Dissipation"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.668955399849964*^9, 3.6689554762168627`*^9}, {
   3.6689555158648252`*^9, 3.6689555851932287`*^9}, 3.668955616939888*^9, 
   3.668955654809738*^9, {3.668955702889482*^9, 3.6689561787218246`*^9}, {
   3.668956222192574*^9, 3.668956238899906*^9}, {3.66895646743332*^9, 
   3.668956569666256*^9}, {3.6689569923743267`*^9, 3.668957055868396*^9}, {
   3.668957094349371*^9, 3.6689571232961493`*^9}, {3.668957154699404*^9, 
   3.668957252936228*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DissipationFrom\[CapitalTheta]", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"begining", "=", 
   RowBox[{
    RowBox[{"-", "\[Pi]"}], "/", "4"}]}], ";", 
  RowBox[{"end", "=", 
   RowBox[{"\[Pi]", "/", "4"}]}], ";", 
  RowBox[{"nstep", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ProgressIndicator", "[", 
  RowBox[{"Dynamic", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[CapitalTheta]", "-", "begining"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"end", "-", "begining"}], ")"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"\[CapitalTheta]", "=", "begining"}], ",", 
    RowBox[{"\[CapitalTheta]", "<", "end"}], ",", 
    RowBox[{"\[CapitalTheta]", "+=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"end", "-", "begining"}], ")"}], "/", "nstep"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DissipationFrom\[CapitalTheta]", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"DissipationFrom\[CapitalTheta]", ",", 
        RowBox[{"{", 
         RowBox[{"\[CapitalTheta]", ",", 
          RowBox[{
           RowBox[{"GeneralLinearAnizatropy", "[", 
            RowBox[{
            "0.000001", ",", "0.000001", ",", "30", ",", "\[CapitalTheta]", 
             ",", 
             FractionBox["\[Pi]", "2"], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "7", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"DissipationFrom\[CapitalTheta]", ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.66895686284931*^9, 3.6689569221803017`*^9}, {
  3.668957278152473*^9, 3.668957278916595*^9}, {3.6689573108593683`*^9, 
  3.668957465600997*^9}, {3.668957570498493*^9, 3.6689576030120687`*^9}, {
  3.668957644560658*^9, 3.66895776811403*^9}, {3.668957798906966*^9, 
  3.668957848041307*^9}, {3.668957880856141*^9, 3.668957893336*^9}, {
  3.668957924376748*^9, 3.6689579286257563`*^9}, {3.668957973339147*^9, 
  3.6689580394474697`*^9}, {3.668958076773239*^9, 3.668958077268139*^9}}],

Cell[BoxData[
 ProgressIndicatorBox[
  Dynamic[($CellContext`\[CapitalTheta] - \
$CellContext`begining)/($CellContext`end - $CellContext`begining)]]], "Output",\

 CellChangeTimes->{
  3.668956936607048*^9, {3.668957246433791*^9, 3.6689572582471123`*^9}, 
   3.668957485063599*^9, {3.668957581152066*^9, 3.6689576039140577`*^9}, {
   3.668957648777898*^9, 3.6689577693769093`*^9}, {3.668957804388464*^9, 
   3.6689578486712923`*^9}, {3.668957882942193*^9, 3.668957894347403*^9}, 
   3.668957929516777*^9, {3.668957974136134*^9, 3.6689580400599957`*^9}, 
   3.6689580792843637`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.01388888888888889], 
     AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJw1VQkwHGYU/rGOuNYOGeJIZAnqqEhdSTP7dkYjoTJ29JBIHCO0wgpN2mgi
dIkjIlVHEBVsmgSlOo5qpKP+FXGLOBNpiE1VSUjRqpEi+hv/vzM7O9+843/v
e+99uzM4yidUESEUQr4bvwZ27324svMFRshjjVf0WjB+ps738I1pjCTzfSLV
FUHZL/xjJaYEI+Fpfvyq4JRCdsBCyRTBlVsyFd4InA4pBLvtIFjicFGatS5Y
zYgOzS3+EyOhoZttPoKW4fGwKZMNrN09GqEA6cbe4r1FkwQ7ip+7K4LPiaao
dOMNnNruYqUE2yrszowV/oGRLE1zlMsB+fz1s/ZGBCPOUscaB8pcNM8nfDtB
7HzD1wvKEBUfGze4jWAEf4fPqoBz60vJroLfif2LevtXqrCm4ZcUY0CwZEd9
3qIa3PfpTO3Mf078a3pqldQhvcA13Uh/A/ObB0w04AN5WUZknpzE/7xyyUsT
DC31s/FWgpGyq02FFtx7qmljZj1OcPeRyVguiE7OOLRbPcNILnYucOHB+FKn
a4TlGHmvUyuZpweRSeXAtRgl/X388oC5IazwUt3rzJ8SbNEvumMGl0tCD/ua
/YZR9MLeR2oOsDmPJxgFhXwdoyyETf5HMPoycdecnjds8v0Yo2eV1s4r/pTf
Rxg5dXIidospn8MYhYXn/JhzjvI3hCX6+WXBHimUr0GMTu2vyyzMpvwMYNMy
34DgpiLKRz8WDWZMBONS2n8fnnZLTuHdrqb99uJr67OC77zu0P56sHT187vq
dpj204XlB6fesn3RQuvvwItHnFyKXTtovW3YS7aVH7HUTeu7j4XJDYG/xvfS
eu7hC8mygj3Ch/R9GQ5ZuOJz7K8H9L1GvGzbYzd2s4vmb8BWTusn0VgrzfcT
liWUVDwWyWh8NTaoHIprSa2n/uXYNK01sry4jNqlWJY+dlTsk01xJkZVVkfH
jEIAsY9sn6xY3Y/ZQdo8N5dikcnioXreZFW7uJTlh+gl//26FfXsffA6cUPP
zaCZ1Qc68uPW8KCd1Q+mtzxj/C16WX+wVMOXm0j7Wf8Q1vhJ1H8Wg4wf2C7j
7rETDzL+wGpgqDH67ADjF/i57V9Np/Ux/uFWVoN5s24Pmw+49oql1tVtbH4Q
VBlgeC6xmc0Xov2aDiaP3mXzh2tGaKLas5btB8zPLQ/Odpaz/YHduRUxHH0p
2y8I0o/VTFC4yvYPJJ/Gfa89lMr2EySqibpCp1i2v4CWai8pjUSy/QYUv32I
kx/I9h9QuJm7m6eI3Qeg4/9yb1cL2f0AGhn+Zl+hA7svQKIhIdibs/sDJFX+
wSPRkN0nmatNSImjHrtfQLLSqmk3Hrtvgg8ESi9y2f0T/y2hM5VaTB+I/V2t
Q0QfqH4Q+5OPFo01mL4AEqp0VSmqM/0h/i46Wf+oMX0i/lbvO86qMv0CJLna
fmFGhekbsWOeAdE3qn/Evpy7uMph+kjyKefoEn2k+klwTdJ5SyWmryT+4fW3
ib5S/SXxlW3vEP2l+kxwXviVPET5niL4ss7pzHWm7wRP3/wMvWH6T/K9EujG
rbL/B2I3n/RWWRH8D25UxHo=
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{-0.7853981633974483, 0.7696902001294993}, {
    0, 0.30347757233448813`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.668956936607048*^9, {3.668957246433791*^9, 3.6689572582471123`*^9}, 
   3.668957485063599*^9, {3.668957581152066*^9, 3.6689576039140577`*^9}, {
   3.668957648777898*^9, 3.6689577693769093`*^9}, {3.668957804388464*^9, 
   3.6689578486712923`*^9}, {3.668957882942193*^9, 3.668957894347403*^9}, 
   3.668957929516777*^9, {3.668957974136134*^9, 3.6689580400599957`*^9}, 
   3.668958092158022*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 43343, 1117, 1636, "Input"],
Cell[CellGroupData[{
Cell[43926, 1141, 2262, 54, 170, "Input"],
Cell[46191, 1197, 581, 11, 33, "Output"],
Cell[46775, 1210, 2898, 59, 249, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
